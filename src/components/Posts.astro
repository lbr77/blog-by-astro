---
const blog = Astro.props.content;
const {Content} = await blog.render();
const themeConfig = Astro.locals.config.themeConfig;
import {get} from "../utils/redis";
---
<article class="post yue">
    <!--    这里应该有一个过时提醒，但是过段时间做吧x TODO -->
    <div class="articleBody" class="full">
        <Content/> <!--  文章内容中代码块渲染似乎没做好。。。还得调试 TODO -->
    </div>
    <div class="social-button"
         data-url={Astro.url.href}
         data-title={blog.data.title}
         data-excerpt={blog.data.excerpt}
         data-img={blog.data.banner}
         data-twitter={themeConfig.twitterId || ""}
         data-weibo={themeConfig.weiboId || ""}
         data-image={blog.data.banner}>
        <!--    赞赏码似乎没啥必要了还是加上吧 TODO-->
        <a role=button
           aria-label="为文章点赞"
           id="social"
           href="javascript:void(0);" onclick="VOID_Vote.vote(this);"
           data-item-id={blog.slug}
           data-type="up"
           data-table="content"
           class="btn btn-normal post-like vote-button"
        >Like <span class="value">{await get(blog.slug)||0}</span>
        </a>
        <a aria-label="分享到微博" href="javascript:void(0);" onclick="Share.toWeibo(this);"
           class="social-button-icon"><i class="voidicon-weibo"></i></a>
        <a aria-label="分享到Twitter" href="javascript:void(0);" onclick="Share.toTwitter(this);"
           class="social-button-icon"><i class="voidicon-twitter"></i></a>
    </div>
    <!--    分页不做了 DEPRECATED -->
</article>
<script is:inline>
    (function () {
        $.each($('iframe'), function (i, item) {
            var src = $(item).attr('src');
            if (typeof src === 'string' && src.indexOf('player.bilibili.com') > -1) {
                // $(item).addClass('bili-player');
                // if (src.indexOf('&high_quality') < 0) {
                //     src += '&high_quality=1'; // 启用高质量
                //     $(item).attr('src', src);
                // }
                $(item).wrap('<div class="bili-player"></div>');
            }
        });
    })();
</script>